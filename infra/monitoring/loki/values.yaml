global:
  imagePullSecrets:
    - name: ghcr-token

deploymentMode: SingleBinary

# Disable distributed components - not needed in SingleBinary mode
backend: { replicas: 0 }
read: { replicas: 0 }
write: { replicas: 0 }

# Disable cache components - they request too many resources (9.6GB memory!)
# SingleBinary mode doesn't need separate cache pods
chunksCache:
  enabled: false
resultsCache:
  enabled: false

singleBinary:
  replicas: 1
  resources:
    requests:
      memory: 256Mi
      cpu: 50m
    limits:
      memory: 512Mi
      cpu: 100m

persistence:
  enabled: true
  storageClass: ""
  size: 2Gi

# Disable canary - it's a testing tool that sends "pppppppppppppppppppp" test logs
# Useful for testing but not needed in production
test:
  enabled: false
lokiCanary:
  enabled: false

loki:
  # Use test schema for filesystem storage (required for validation)
  useTestSchema: true

  commonConfig:
    replication_factor: 1
    ring:
      kvstore:
        store: inmemory

  auth_enabled: false

  distributor:
    ring:
      kvstore:
        store: inmemory

  ingester:
    autoforget_unhealthy: true
    lifecycler:
      ring:
        kvstore:
          store: inmemory

  memberlist:
    join_members: []

  limits_config:
    reject_old_samples: true
    reject_old_samples_max_age: 168h
    retention_period: 5d
    ingestion_rate_strategy: local

  storage:
    type: filesystem
    bucketNames:
      chunks: chunks
      ruler: ruler
      admin: admin

gateway:
  enabled: true
  verboseLogging: false
  
  service:
    annotations:
      prometheus.io/scrape: "false"

  resources:
    requests:
      cpu: 10m
      memory: 32Mi
    limits:
      cpu: 50m
      memory: 64Mi
